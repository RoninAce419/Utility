<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>Glint</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>
    <script src="js/pace.min.js"></script>
    <script src="./node_modules/web3/dist/web3.min.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

</head>

<body id="top" onload="checkergon(), checkstatus()">

    <header class="s-header">

       
        <nav class="header-nav">

            <a href="#0" class="header-nav__close" title="close"><span>Close</span></a>

            <div class="header-nav__content">
                <h3>Navigation</h3>
                
                <ul class="header-nav__list">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="wallet.html">Wallet</a></li>
                    <li class="current"><a href="buy.html">Buy</a></li>
                    <li><a href="sell.html">Sell</a></li>
                    <li><a href="support.html">Support</a></li>
                </ul>
            </div> <!-- end header-nav__content -->

        </nav>  <!-- end header-nav -->

        <a class="header-menu-toggle" href="#0">
            <span class="header-menu-text">Menu</span>
            <span class="header-menu-icon"></span>
        </a>

    </header> <!-- end s-header -->

    <!-- contact
    ================================================== -->
    <section id="contact" class="s-contact">

        <div class="overlay"></div>
        <div class="contact__line"></div>
		<div class="row">
			<div class="col-md-3">
				
			</div>
			<div class="col-md-4">
				
			</div>
			<div class="col-md-2">
				<a class="token-menu">
					<span class="token-menu-text" id="ergonshow">&nbsp;&nbsp;ERGON Tokens: &nbsp;&nbsp;</span>
				</a>
		</div>
        <div class="row section-header" data-aos="fade-up">
            <div class="row">
				<div class="col-md-3">
					<div id="useergon" style="color:white; font-family: montserrat-light, sans-serif;">abc</div>
					<br />
					<a onclick="usetoken()" class="btn btn--primary full-width">&nbsp;&nbsp;Toggle ERGON use&nbsp;&nbsp;</a>
				</div>
			</div>
        </div>

        <div class="row contact-content" data-aos="fade-up">
            
            <div class="contact-primary">
                <h3 class="h6">Sell Electricity</h3>

				<h4 class="text-center" style="color: white; font-family: montserrat-light, sans-serif;">Current Battery Level: 200</h4>
				<br /><br />
                <form name="contactForm" id="contactForm" method="post" action="" novalidate="novalidate">
                    <fieldset>

                    <div class="form-field">
                            Value in Energy Units<input onkeyup="mytion()" name="killoWatt" type="number" id="killoWattID" placeholder="" value="" minlength="2" required="" aria-required="true" class="full-width">
                    </div>
                    <a class="btn" onclick="tion()" id="buttonbutton" >Update</a>
                    <br /><br />
                    <div class="form-field">
                            Tokens Credited<input name="tokens" type="number" id="tokenID" placeholder="" value="" required="" disabled="true" class="full-width" aria-required="true">
                    </div>
                    <br /><br />
                    <div>
                        <label for="walletInput" style="color: white;">Transfer tokens to Wallet</label>
                            <div class="cl-custom-select">
                                <select class="full-width" id="walletInput">
										<option style="color:black;" value="0x9a351962d2a32bad82c1703990342f76ec57de39">Sample Wallet #1</option>
										<option style="color:black;" value="0xc76bbb56b18541cd6f1bd164bb083f1efe51819e">Sample Wallet #2</option>
										<option style="color:black;" value="0x893206af4fee54f473bd0ca5ff07b3ab2f1a59ec">Sample Wallet #3</option>
                                </select>
                            </div>
                    </div>
                    <div class="form-field">
                        <a onclick="sell()" class="btn btn--primary full-width">Sell</a>
                        <div class="submit-loader">
                            <div class="text-loader">Sending...</div>
                            <div class="s-loader">
                                <div class="bounce1"></div>
                                <div class="bounce2"></div>
                                <div class="bounce3"></div>
                            </div>
                        </div>
                    </div>
    
                    </fieldset>
                </form>
            </div> <!-- end contact-primary -->
            <br /><br />
            <div class="contact-secondary">
                <div class="contact-info">

                    <h3 class="h6 hide-on-fullwidth"></h3>

                    <div class="cinfo">
                        <h5>Current Market Rate</h5>
                        <p>
                            1 Token = $ 4.9<br>
                        </p>
                    </div>

                    <div class="cinfo">
                        <h5>Electricity Market Rate</h5>
                        <p>
                            1 Token = 1 Energy Unit(s)<br>
                        </p>
                    </div>

                   
                </div> <!-- end contact-info -->
            </div> <!-- end contact-secondary -->

        </div> <!-- end contact-content -->

    </section> <!-- end s-contact -->


  

    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader">
            <div class="line-scale-pulse-out">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>


    <!-- Java Script
    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

	<script>
			document.getElementById("killoWattID").addEventListener("focus", tion);
			function mytion()
			{
				document.getElementById("tokenID").value = 0;
			}
			function tion()
			{
				var x = document.getElementById("killoWattID").value
				x = x * 1;
				document.getElementById("tokenID").value = x;
			}
				
	</script>

    <script>
        if (typeof web3 !== 'undefined') 
		{
			web3 = new Web3(web3.currentProvider);
		} 
      else 
        {
        	// set the provider you want from Web3.providers
        	web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
        }

		
        var serenitycont = web3.eth.contract([
	{
		"constant": false,
		"inputs": [],
		"name": "acceptOwnership",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "spender",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "spender",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			},
			{
				"name": "data",
				"type": "bytes"
			}
		],
		"name": "approveAndCall",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "offDemand",
		"outputs": [
			{
				"name": "status",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_from",
				"type": "address"
			},
			{
				"name": "energy_reading",
				"type": "uint256"
			}
		],
		"name": "SC_Consumer",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_from",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "SC_DecreaseSupply",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_from",
				"type": "address"
			},
			{
				"name": "energy_reading",
				"type": "uint256"
			}
		],
		"name": "SC_Generator",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "to",
				"type": "address"
			},
			{
				"name": "topup",
				"type": "uint256"
			}
		],
		"name": "SC_IncreaseSupply",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_from",
				"type": "address"
			},
			{
				"name": "energy_readingIN",
				"type": "uint256"
			},
			{
				"name": "energy_readingOUT",
				"type": "uint256"
			},
			{
				"name": "batteryLevel",
				"type": "uint256"
			}
		],
		"name": "SC_Prosumer",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "toggle",
				"type": "address"
			}
		],
		"name": "SC_useTokens",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "to",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "transfer",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "tokenAddress",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "transferAnyERC20Token",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "from",
				"type": "address"
			},
			{
				"name": "to",
				"type": "address"
			},
			{
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [
			{
				"name": "success",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "high_treshold",
				"type": "uint256"
			}
		],
		"name": "UpdateDemand",
		"outputs": [
			{
				"name": "status",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"name": "_from",
				"type": "address"
			},
			{
				"indexed": true,
				"name": "_to",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"name": "tokenOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"name": "spender",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "Low_Treshold",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "tokens",
				"type": "uint256"
			}
		],
		"name": "Alert_Treshold",
		"type": "event"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "tokenOwner",
				"type": "address"
			},
			{
				"name": "spender",
				"type": "address"
			}
		],
		"name": "allowance",
		"outputs": [
			{
				"name": "remaining",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "tokenOwner",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"name": "balance",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "demand",
		"outputs": [
			{
				"name": "",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "newOwner",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "tokenOwner",
				"type": "address"
			}
		],
		"name": "SC_GetBalance",
		"outputs": [
			{
				"name": "balance",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "toggle",
				"type": "address"
			}
		],
		"name": "SC_getTokenStatus",
		"outputs": [
			{
				"name": "status",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "upper_limit",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]);


    var addcont = serenitycont.at('0xb2bfc4a9c903c352227b538ad9a1da8f574d1264');
    console.log(addcont);

	function checkergon()
	{
			addcont.SC_GetBalance('0x2b7466b478a7d96566066048111cb1d5f9643dd2',function(err,res){
            if(!err)
            {
                $("#ergonshow").show();
                $("#ergonshow").html("&nbsp;&nbsp;ERGON Tokens: " + res.c[0] + "&nbsp;&nbsp;");
            }
            else
            {
                console.log(err);
            }
		});
	}

	function checkstatus()
	{
		addcont.SC_getTokenStatus('0x2b7466b478a7d96566066048111cb1d5f9643dd2',function(err,res){
				if(!err)
				{
					$("#useergon").show();
					$("#useergon").html(res + 0);
					console.log(res);
				}
				else
				{
					console.log(err);
				}});
	}

	function usetoken()
	{
			addcont.SC_useTokens('0x2b7466b478a7d96566066048111cb1d5f9643dd2', {to:'0xb2bfc4a9c903c352227b538ad9a1da8f574d1264', from:'0x2b7466b478a7d96566066048111cb1d5f9643dd2'},function(err,res){
            if(!err)
            {
				checkstatus();
            }
            else
            {
                console.log(err);
            }
		});
	}

	function sell(){
        addcont.transaction ($("#walletInput").val(), '0x9d9209e137a459323bed94edeb550e80f5372946', $("#killoWattID").val(), 2,{to:'0x80300bbfdd01b667135472742d8a8150b5bb28ab', from:'0x9a351962d2a32bad82c1703990342f76ec57de39'},function(err,res){
            if(!err){
                alert("success");
            }
            else{
                console.log(err);
            }
        });
    }

    </script>
</body>

</html>